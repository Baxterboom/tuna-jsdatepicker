"use strict";var JSTemplateClass=function(){function s(){if(this.cache={},!s.encode){var e=document.createElement("textarea");s.encode=function(t){return e.textContent=t,e.innerHTML}}}return s.prototype.parse=function(t,e,n){var i="";try{var a=n?this.cache[t]:null;if(!a){var o="var p=[],c=JSTemplateClass,e=c.encode.bind(c),w=write=p.push.bind(p);with(o){w('"+t.replace(/[\r\t\n]/g," ").replace(/'(?=[^#]*%>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g,"'+e($1)+'").split("<%").join("');\n").split("%>").join("w('").replace(/\s+/g," ")+"');}return p.join('');";a=new Function("o",o),n&&(this.cache[t]=a)}return a(e)}catch(t){i=t.message}return console.error(i),'<jstemplate title="'+s.encode(i)+'">&#8224;</jstemplate>'},s}(),JSTemplate=new JSTemplateClass;!function(i){function a(e,n){var t=function(t){$(t.target).closest(e).length||(i(),n())};setTimeout(function(){return document.addEventListener("click",t)});var i=function(){return document.removeEventListener("click",t)};return i}i.registerOutsideClickEventHandler=a;var n=function(){function n(t,e){this.cancelOutsideClickEventHandler=function(){},this.options=$.extend({},n.options,e),this.date=moment(this.options.date),this.view=this.options.view||"days",this.input=$(t),this.element=i.templates.parse(i.templates.main,this),this.trigger=this.element.find(".t-trigger"),this.placment=$(this.options.placement||this.element),this.setupViews(),this.setupInput(),this.setupElements()}return n.prototype.setupElements=function(){var t=this;this.input.after(this.element),this.input.addClass("t-input"),this.element.append(this.input),this.trigger.on("click",function(){return t.toggle()})},n.prototype.setupInput=function(){var n=this;this.input.on("keydown",function(t){switch(t.which||t.keyCode){case 9:case 13:var e=n.options.inputFormat;return n.date=moment(n.input.val(),e),n.invokeOnChange()}})},n.prototype.setupViews=function(){var t=this.options;t.views.indexOf(t.view)<0&&t.views.unshift(t.view)},n.prototype.navigate=function(t){var e=this.options.views,n=e.indexOf(this.view);n+="up"==t?1:-1,this.view=e[n]||this.options.view,this.render()},n.prototype.toggle=function(t){return t||this.picker?this.close():this.render()},n.prototype.remove=function(){this.picker&&(this.picker.remove(),this.picker=void 0),this.cancelOutsideClickEventHandler()},n.prototype.close=function(){this.remove(),this.view=this.options.view},n.prototype.step=function(t,e){if(t.step){var n=t.step,i=n.count,a=e?i:-i;this.date=moment(this.date).add(a,n.unit),this.render()}},n.prototype.place=function(){var t=this;if(this.picker){var e=this.input.offset(),n=(this.input.outerHeight()||0)+4;e&&!this.picker.closest(this.element).length&&this.picker.css({top:e.top+n,left:e.left}),this.cancelOutsideClickEventHandler=a(this.picker,function(){return t.close()})}},n.prototype.render=function(){var t=this;return this.remove(),this.picker=i.templates.mount(i.templates.picker,this,this.placment),this.picker.find(".t-item").on("click",function(){t.invokeOnChange()||t.navigate("down")}),this.place(),this.picker},n.prototype.invokeOnChange=function(){var t=this.date,e=this.options;return this.view==e.view&&(e.date=t,this.input.val(moment(t).format(e.inputFormat)),this.input.focus(),this.close(),e.onChange&&e.onChange(this.date,this.input),!0)},n.options={view:"days",views:["days","months","years","decades"],dateFormat:moment.localeData().longDateFormat("L"),inputFormat:moment.localeData().longDateFormat("L"),showToday:!0,showNavigator:!1},n}();i.DatePicker=n,i.create=function(t,e){return new n(t,e)}}(JSDatepicker||(JSDatepicker={})),function(t){!function(t){function a(t,e){var n=$.extend({},e,{template:t});return $(JSTemplate.parse(t.template,n,!0))}t.parse=a,t.mount=function(t,e,n){var i=a(t,e);return n.append(i),t.onMounted&&t.onMounted(e,i),i}}(t.templates||(t.templates={}))}(JSDatepicker||(JSDatepicker={}));var JSDatepicker,fnRender=JSDatepicker.DatePicker.prototype.render;JSDatepicker.DatePicker.prototype.render=function(){console.time("render"),$(".t-debug").remove(),JSDatepicker.templates.mount(JSDatepicker.templates.debug,this,this.placment),console.log((new Error).stack);var t=fnRender.call(this);return console.timeEnd("render"),t},function(n){var t;(t=n.templates||(n.templates={})).debug={config:{name:"debug"},template:'\n          <div class="t-debug">\n            <textarea style="width:100%;height:400px";></textarea>\n          </div>',onMounted:function(t,e){$(".t-debug textarea").val(n.templates.json(t,void 0,4)+n.templates.json(t.options,void 0,4))}},t.json=function(a,o,t){var s=[],r=[];return JSON.stringify(a,function(t,n){if(2e3<r.length)return"object too long";var i=0;if(r.forEach(function(t,e){t===n&&(i=e)}),""==t)return r.push(a),s.push("root"),n;if(i+""!="false"&&"object"==typeof n)return"root"==s[i]?"#pointer to root":"#see "+(n&&n.constructor?n.constructor.name.toLowerCase():typeof n)+" with key "+s[i];var e=t||"#empty key";return r.push(n),s.push(e),o?o(t,n):n},t)}}(JSDatepicker||(JSDatepicker={})),function(t){(t.templates||(t.templates={})).foot={config:{name:"foot"},template:'\n            <div class="t-foot">\n            <%\n                if(options.showToday) w(\'<button class="t-today">Today</button>\');\n\n                if(options.showNavigator) {\n                    var items = "";\n\n                    options.views.forEach(function(item) {\n                        const selected = view == item ? "selected" : "";\n                        items += \'<option class="t-nav t-view" <%=selected%>><%=item%></option>\';\n                    });  \n                    \n                    w(\'<select class="t-nav t-view">\');\n                    w(items);\n                    w(\'</select>\');\n                }\n            %>\n            </div>',onMounted:function(e,t){t.find("button.t-today").on("click",function(t){e.view=e.options.view,e.date=moment()}),t.find(".t-view").on("change",function(t){e.view=$(t.target).val()})}}}(JSDatepicker||(JSDatepicker={})),function(t){(t.templates||(t.templates={})).head={config:{name:"head",step:{count:1,unit:"M"},headerFormat:"DD MMMM YYYY"},template:'\n            <div class="t-head">\n                <% if(template.config.step) w(\'<button class="t-nav t-prev"></button>\'); %>\n                <button class="t-nav t-title"><%=date.format(template.config.headerFormat)%></button>\n                <% if(template.config.step) w(\'<button class="t-nav t-next"></button>\'); %>\n            </div>\n            ',onMounted:function(n,t){var i=this,e=t.find("button.t-prev, button.t-next");e.toggle(null!=this.config.step),e.on("click",function(t){var e=$(t.target);n.step(i.config,e.hasClass("t-next"))}),t.find("button.t-title").on("click",function(t){n.navigate("up")})}}}(JSDatepicker||(JSDatepicker={})),function(t){(t.templates||(t.templates={})).main={config:{name:"main"},template:'\n            <div class="t-jsdatepicker">\n                <div class="t-trigger"></div>\n            </div>'}}(JSDatepicker||(JSDatepicker={})),function(t){var o;(o=t.templates||(t.templates={})).picker={config:{name:"picker"},template:'<div class="t-jsdatepicker-picker"></div>',onMounted:function(t,e){t.picker=e;var n=o[t.view],i=$.extend({},o.head);$.extend(i.config,n.config,i.config);var a=o.foot;o.mount(i,t,e),o.mount(n,t,e),o.mount(a,t,e)}}}(JSDatepicker||(JSDatepicker={})),function(t){(t.templates||(t.templates={})).days={config:{name:"days",step:{unit:"M",count:1},headerFormat:"MMMM YYYY",showWeeknumbers:!0},template:'\n            <%\n                function renderWeekCell(text) {\n                    w(template.config.showWeeknumbers ?\'<div class="t-item t-week">\'+ text +\'</div>\' : \'\');\n                }\n\n                function renderWeekdays() {\n                    renderWeekCell(\'w\');\n\n                    moment.weekdaysMin().forEach(function(f) {\n                        w(\'<div class="t-item t-weekday">\'+ f +\'</div>\');\n                    });\n                }\n            %>\n            <div class="t-days">\n                <div class="t-head">\n                    <div class="t-week">\n                    <%\n                        renderWeekdays();\n                    %>\n                    </div>\n                </div>\n                <div class="t-body">\n                <% \n                    var t = {\n                        date: options.date,\n                        end: moment(date).endOf("month").endOf("isoWeek"),\n                        start: moment(date).startOf("month").startOf("isoWeek"),\n                        week: null,\n                        today: moment(),\n                        current: null\n                    };\n\n                    t.current = moment(t.start);\n\n                    while(t.current < t.end) {\n                        if(t.week != t.current.isoWeek()) {\n                            if(t.week) w(\'</div>\');\n                            w(\'<div class="t-week">\');\n                            \n                            t.week = t.current.isoWeek();\n                            renderWeekCell(t.week);\n                        }\n                        \n                        var item = {\n                            value: t.current.date(),\n                            classes: ["t-item", "t-day"]\n                        };\n\n                        if(t.current.isSame(t.date, "day")) item.classes.push("active");\n                        if(t.current.isSame(t.today, "day")) item.classes.push("t-today");\n                        if(!t.current.isSame(date, "month")) item.classes.push("t-other");\n                        w(\'<div class="<%=item.classes.join(" ")%>" data-date="<%=t.current.format(\'YYYY-MM-DD\')%>"><%=item.value%></div>\');\n                        t.current.add(1, "d");\n                    }\n                %>\n                </div>\n            </div>',onMounted:function(n,t){t.find(".t-body .t-day").on("click",function(t){var e=$(t.target).attr("data-date");n.date=moment(e)})}}}(JSDatepicker||(JSDatepicker={})),function(t){(t.templates||(t.templates={})).decades={config:{name:"decades",step:{unit:"y",count:100},headerFormat:"YYYY"},template:'\n            <div class="t-decades">\n            <% \n                var amount = template.config.step.count / 2;\n\n                var t = { \n                    date: options.date,\n                    end: moment(date).add(amount, "Y"),\n                    start: moment(date).add(-(amount), "Y"),\n                    next: null,\n                    current: null,\n                    today: moment()\n                };\n\n                t.current = moment(t.start);\n\n                while(t.current < t.end) {\n                    var item = {\n                        value: t.current.year(),\n                        classes: ["t-item", "t-decade"]\n                    };\n\n                    t.next = moment(t.current).add(10, "y");\n\n                    if(t.date.isBetween(t.current, t.next, "Y", "[]")) item.classes.push("active");\n                    if(t.today.isBetween(t.current, t.next, "Y", "[]")) item.classes.push("t-today");\n                    \n                    w(\'<div class="<%=item.classes.join(" ")%>"><%=item.value +\' - \'+ t.next.year()%></div>\');\n                    t.current = t.next.add(1, "y");\n                }\n            %>\n            </div>',onMounted:function(n,t){var e=this.config.step,i=n.picker;if(e&&i){var a=n.date,o=this.config.headerFormat,s=e.count/2,r=moment(a).add(-s,e.unit).format(o),c=moment(a).add(s+9,e.unit).format(o);i.find(".t-nav.t-title").text(r+" - "+c),t.find(".t-item.t-decade").on("click",function(t){var e=0;$(t.target).text().split(" - ").forEach(function(t){e+=parseInt(t)}),n.date.year(e/2)})}}}}(JSDatepicker||(JSDatepicker={})),function(t){(t.templates||(t.templates={})).months={config:{name:"months",step:{unit:"y",count:1},headerFormat:"YYYY"},template:'\n            <div class="t-months">\n            <% \n                var t = {\n                    date: options.date,\n                    today: moment(),\n                    current: moment(date).startOf("year")\n                };\n                \n                moment.monthsShort().forEach(function(m) {\n                    var item = {\n                        value: m,\n                        classes: ["t-item", "t-month"]\n                    };\n\n                    if(t.current.isSame(t.date, "M")) item.classes.push("active");\n                    if(t.current.isSame(t.today, "M")) item.classes.push("t-today");\n\n                    w(\'<div class="<%=item.classes.join(" ")%>"><%=item.value%></div>\');\n                    t.current.add(1, "M");\n                });\n            %>\n            </div>',onMounted:function(n,t){t.find(".t-item.t-month").on("click",function(t){var e=$(t.target).index();n.date.month(e)})}}}(JSDatepicker||(JSDatepicker={})),function(t){(t.templates||(t.templates={})).weeks={config:{name:"weeks",step:{unit:"M",count:1},headerFormat:"MMMM YYYY",showWeeknumbers:!0},template:'\n            <%\n                function renderWeekCell(text) {\n                    w(template.config.showWeeknumbers ?\'<div class="t-item t-week">\'+ text +\'</div>\' : \'\');\n                }\n\n                function renderWeekdays() {\n                    renderWeekCell(\'w\');\n\n                    moment.weekdaysMin().forEach(function(f) {\n                        w(\'<div class="t-item t-weekday">\'+ f +\'</div>\');\n                    });\n                }\n            %>\n            <div class="t-days t-weeks">\n                <div class="t-head">\n                    <div class="t-week">\n                    <%\n                        renderWeekdays();\n                    %>\n                    </div>\n                </div>\n                <div class="t-body">\n                <% \n                    var t = {\n                        date: options.date,\n                        end: moment(date).endOf("month").endOf("isoWeek"),\n                        start: moment(date).startOf("month").startOf("isoWeek"),\n                        week: null,\n                        today: moment(),\n                        current: null\n                    };\n\n                    t.current = moment(t.start);\n\n                    while(t.current < t.end) {\n                        if(t.week != t.current.isoWeek()) {\n                            if(t.week) w(\'</div>\');\n\n                            w(t.current.isSame(options.date, "week") \n                                ? \'<div class="t-week active">\'\n                                : \'<div class="t-week">\'\n                            );\n\n                            t.week = t.current.isoWeek();\n                            renderWeekCell(t.week);\n                        }\n                        \n                        var item = {\n                            value: t.current.date(),\n                            classes: ["t-item", "t-day"]\n                        };\n\n                        if(t.current.isSame(t.date, "day")) item.classes.push("active");\n                        if(t.current.isSame(t.today, "day")) item.classes.push("t-today");\n                        if(!t.current.isSame(date, "month")) item.classes.push("t-other");\n                        w(\'<div class="<%=item.classes.join(" ")%>" data-date="<%=t.current.format(\'YYYY-MM-DD\')%>"><%=item.value%></div>\');\n                        t.current.add(1, "d");\n                    }\n                %>\n                </div>\n            </div>',onMounted:function(n,t){t.find(".t-item.t-day").on("click",function(t){var e=$(t.target).attr("data-date");n.date=moment(e).startOf("isoWeek")})}}}(JSDatepicker||(JSDatepicker={})),function(t){(t.templates||(t.templates={})).years={config:{name:"years",step:{unit:"y",count:12},headerFormat:"YYYY"},template:'\n            <div class="t-years">\n            <% \n                var amount = template.config.step.count / 2;\n\n                var t = {\n                    date: options.date,\n                    end: moment(date).add(amount, "Y"),\n                    start: moment(date).add(-(amount), "Y"),\n                    today: moment(),\n                    current: null\n                };\n\n                t.current = moment(t.start);\n\n                while(t.current < t.end) {\n                    var item = {\n                        value:  t.current.year(), \n                        classes: ["t-item", "t-year"]\n                    };\n\n                    if(t.current.isSame(t.date, "d")) item.classes.push("active");\n                    if(t.current.isSame(t.today, "Y")) item.classes.push("t-today");\n\n                    w(\'<div class="<%=item.classes.join(" ")%>"><%=item.value%></div>\');\n                    t.current.add(1, "y");\n                }\n            %>\n            </div>',onMounted:function(i,t){var e=this.config.step,n=i.picker;if(e&&n){var a=i.date,o=this.config.headerFormat,s=e.count/2,r=moment(a).add(s-1,e.unit).format(o),c=moment(a).add(-s,e.unit).format(o);n.find(".t-head .t-nav .t-title").text(c+" - "+r),t.find(".t-item.t-year").on("click",function(t){var e=$(t.target),n=parseInt(e.text());i.date.year(n)})}}}}(JSDatepicker||(JSDatepicker={})),function(t){(JSDatepicker||(JSDatepicker={})).timeout=function(t,e){return new n(t,e)};var n=function(){function i(t,e){var n=this;this.action=t,this.id=0,this.cancel(),(i.current[this.action]=this).id=setTimeout(function(){n.action(),n.cancel()},e)}return i.prototype.cancel=function(){var t=i.current[this.action];t&&(clearTimeout(t.id),delete i.current[this.action])},i.current={},i}()}();